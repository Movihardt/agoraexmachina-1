{% extends 'base.html.twig' %}

{% block body %}
	<div class="container-fluid">
		<div class="row">
			{% include 'admin.menu.html.twig' %}
			<main class="col-11 col-lg-10 ml-sm-auto">
				<div class="row mb-2" >
					<div class="col-12">
						<h4>{{'workshop' | trans }} : {{ form.vars.value.name }}</h4>
					</div>
				</div>
				<div class="row mb-2" >
					<div class="col-12">
						<a href="{{ path('workshop_admin') }}" class="btn btn-secondary btn-sm"><i class="bi bi-arrow-bar-left"></i> {{ 'list_of' | trans }} {{ 'workshops' | trans | lower }}</a>
						<a href="{{ path('workshop_delete', {'workshop' : form.vars.value.id}) }}" class="btn btn-danger btn-sm" data-toggle="deleteConfirmation"><i class="bi bi-trash"></i> {{ 'delete' | trans }}</a>
						<a href="{{ path('workshop_add_document', {'workshop' : form.vars.value.id}) }}" class="btn btn-info btn-sm"><i class="bi bi-plus-square"></i> {{ 'add_document' | trans }}</a>
						<a href="{{ path('workshop_edit_document', {'workshop' : form.vars.value.id}) }}" class="btn btn-info btn-sm"><i class="bi bi-lis-task"></i> {{ 'edit_document' | trans }}</a>

					</div>
				</div>
				<div class="row mb-2" >
					<div class="col-12">
						{% include 'flashbag.html.twig' %}
					</div>
				</div>
				<div class="row" >
					<div class="col-2">
						<div class="card">
							<div class="card-body ">
								{% if workshop.image %}
									<img src="{{ vich_uploader_asset(workshop, 'imageFile') | imagine_filter('themes_home')}}" class="img-fluid"/>
								{% else %}
									<img src="{{asset('img/logo_aem-lg.png')}}" class="img-fluid"/>
								{%	endif %}
							</div>
						</div>
					</div>
					<div class="col-10">
						<div class="card">
							<div class="card-body">
								{% form_theme form 'bootstrap_4_layout.html.twig' %}
								{{ form_start(form, {'attr': {'id': 'form_upload'}}) }}
								{{ form_row(form.theme) }}
								<div>{{ 'category' | trans }} :
									<span id="js_category_theme_name">
                                    </span>
								</div>
								{{ form_rest(form) }}
								{{ form_end(form) }}							</div>
						</div>
					</div>
				</div>
			</main>
		</div>
	</div>
{% endblock %}

{% block javascript %}
{{ parent() }}
{#  On a besoin de la version non slim de jquery pour avoir acces a l'ajax #}
			 <script src="{{ asset('js/jquery-3.6.0.min.js') }}"></script>
<script >

$("#workshop_imageFile_file").change(function () {
    filePreview(this);
});


$(document).ready(function () {
    let theme = $('#workshop_theme option:selected').text();
    $.ajax({
        url: '{{ path('category_ajax_theme') }}/'+theme,
        type: 'POST',
        dataType: 'json',
        async: true,

        success: function (data,status) {
            console.log(data);
             $('#js_category_theme_name' ).html("<strong>"+data[0].category+"</strong>");
        },
        error: function (xhr, textStatus, errorThrown) {
                    alert('Ajax request failed.');
                }
    });



    $('#workshop_theme').on('change',function () {
       theme = $('#workshop_theme option:selected').text();
    $.ajax({
        url: '{{ path('category_ajax_theme') }}/'+theme,
        type: 'POST',
        dataType: 'json',
        async: true,

        success: function (data,status) {
            console.log(data);
             $('#js_category_theme_name' ).html("<strong>"+data[0].category+"</strong>");
        },
        error: function (xhr, textStatus, errorThrown) {
                    alert('Ajax request failed.');
                }
    });







   })

})


</script>
{% endblock %}